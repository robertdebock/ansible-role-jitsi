---
#
# Ansible managed
#
language: python

python:
  - "3.8"

services:
  - docker

env:
  global:
    namespace="robertdebock"
  matrix:
    - image="debian" tag="latest"
    - image="debian" tag="bullseye"
    - image="ubuntu" tag="latest"

cache:
  - pip

install:
  - pip install --upgrade pip
  - pip install tox

script:
  - function retry { counter=0 ; until "$@" ; do exit=$? ; counter=$(($counter + 1)) ; if [ $counter -ge 3 ] ; then return $exit ; fi ; done ; return 0; } ; retry tox --parallel all

notifications:
  webhooks: https://galaxy.ansible.com/api/v1/notifications/
  slack: "aQ7wa/MM4idKvNoMWe2OyXkSpBvHJupJFxWcLcdjh8Kr2i3JY1/904amD/+qoFB5/hXUrLLF2eH+OsPCQv3FHHjTOUNIt515lNTgpZs8oA66ppxWlRExs+9w+2P+WYvVtWnbcVN6hbOALiEaThyQXqo22mpURSylqBqVjBCCnRAGRQSdW7kX+hcU+dX5IqD8yNDUPcmWF19PaDe+hwSlE8ucvDuofCHHcpIbRIGzP6k0nTHnqfCWsIIy14SeszFu/lB0f9Z5ootEiPuE8j+rXeBekw3PL6BxlrtoXzcB2u5Lv/gGbMRHSNz9JjssS/c8O6d+XZDFAXv1gOfpbqk3+E3ym2GJrqlK93js0fsA21W2QNKf06AplgqZh7T2yssTFG2JTmkcFr8zA6o2Y8QeP8g9lkNevBkVYjYrA5TS6UcHVNbYKhhulXbQ9XNwAiz5C29CHoBMTmyFU+1OhI5QWlBaJ5hX9aLJvTBmdcXBcjd7Yw4AvStGDxWtoAwsgCJ9dqugrGNUU+4a5lQ27xYAi7sIr3MTH0yeUWGh4m1k2z2/dyJiEk986dnWA/+3E7fPyo9rccNxEw4U7XbHDmnAjz1Q3VKOe3nJs12OVItWIc/ozq6ovsJQhmFL6BMUM95ruHqeMUjask1nXymFg8EBP2P2k8fGpoN1VqQs7DZThI8="
  email: false
